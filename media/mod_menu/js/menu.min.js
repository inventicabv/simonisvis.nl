function _extends(){return _extends=Object.assign?Object.assign.bind():function(o){for(var c=1;c<arguments.length;c++){var e=arguments[c];for(var t in e)({}).hasOwnProperty.call(e,t)&&(o[t]=e[t])}return o},_extends.apply(null,arguments)}/**
 * @copyright  (C) 2019 Open Source Matters, Inc. <https://www.joomla.org>
 * @license    GNU General Public License version 2 or later; see LICENSE.txt
 */(()=>{class o{constructor(e,t={}){var r,n,a;this.nav=e;const l=document.documentElement.getAttribute("dir")||getComputedStyle(document.documentElement).direction||o.defaultSettings.dir;this.settings=_extends({},o.defaultSettings,t),this.settings=_extends({},o.defaultSettings,{dir:(r=t.dir)!=null?r:l},t),this.idPrefix=(n=(a=this.nav)==null?void 0:a.id)!=null?n:`nav-${Math.floor(Math.random()*1e5)}`,this.topLevelNodes=this.nav.querySelectorAll(":scope > li"),this.topLevelNodes.forEach(u=>{const d=u.querySelectorAll("ul"),s=[];if(d.forEach(i=>{i.setAttribute("aria-hidden","true"),i.classList.remove(this.settings.menuHoverClass),i.id=`${this.idPrefix}-submenu${o.idCounter}`,o.idCounter+=1,s.push(i.id)}),d.length>0){const i=u.querySelector("[aria-expanded]");i?.setAttribute("aria-controls",s.join(" "))}}),e.addEventListener("keydown",this.onMenuKeyDown.bind(this)),e.addEventListener("click",this.onClick.bind(this))}onMenuKeyDown(e){const t=e.target.closest("li");if(!t)return;const r=t.querySelectorAll("ul");switch(e.key){case"ArrowUp":e.preventDefault(),this.tabPrev();break;case"ArrowLeft":e.preventDefault(),this.settings.dir==="rtl"?this.tabNext():this.tabPrev();break;case"ArrowDown":e.preventDefault(),this.tabNext();break;case"ArrowRight":e.preventDefault(),this.settings.dir==="rtl"?this.tabPrev():this.tabNext();break;case"Enter":if(e.target.nodeName==="SPAN"&&e.target.parentNode.nodeName!=="A"&&r.length>0){var n;e.preventDefault(),this.toggleSubMenu(t,r,((n=r[0])==null?void 0:n.getAttribute("aria-hidden"))==="true")}break;case" ":case"Spacebar":if(r.length>0){var a;e.preventDefault(),this.toggleSubMenu(t,r,((a=r[0])==null?void 0:a.getAttribute("aria-hidden"))==="true")}break;case"Escape":{e.preventDefault();const s=this.getTopLevelParentLi(e.target);if(!s)break;const i=s.querySelectorAll("ul");i.length>0&&this.toggleSubMenu(s,i,!1),s.querySelectorAll(':scope > [tabindex]:not([tabindex="-1"]), a, button').forEach(b=>{b.hasAttribute(["aria-expanded"])&&b.focus()});break}case"End":{var l;e.preventDefault();const s=(l=t.closest("ul"))==null?void 0:l.querySelectorAll(":scope > li");for(let i=s.length-1;i>=0;i-=1){const b=s[i].querySelector(':scope > [tabindex]:not([tabindex="-1"]), a, button');if(b){b.focus();return}}break}case"Home":{var u;e.preventDefault();const s=(u=t.closest("ul"))==null?void 0:u.querySelector(":scope > li:first-child");if(s){var d;(d=s.querySelector(':scope > [tabindex]:not([tabindex="-1"]), a, button'))==null||d.focus()}break}}}onClick(e){var t,r,n,a;if(!((t=e.target)!=null&&t.hasAttribute("aria-expanded"))&&!((r=e.target)!=null&&r.closest("[aria-expanded"))||((n=e.target)==null?void 0:n.nodeName)==="A"||((a=e.target)==null?void 0:a.nodeName)==="SPAN"&&e.target.parentNode.nodeName==="A")return;const l=e.target.closest("li"),u=l?.querySelectorAll("ul");if(u&&u.length>0){var d;e.preventDefault(),this.toggleSubMenu(l,u,((d=u[0])==null?void 0:d.getAttribute("aria-hidden"))==="true")}}toggleSubMenu(e,t,r=!1){r&&this.nav.querySelectorAll('ul[aria-hidden="false"]').forEach(a=>{var l;a.setAttribute("aria-hidden","true"),a.classList.remove(this.settings.menuHoverClass),(l=this.getTopLevelParentLi(a))==null||(l=l.querySelector(":scope > [aria-expanded]"))==null||l.setAttribute("aria-expanded","false")}),t.forEach(n=>{n.setAttribute("aria-hidden",r?"false":"true"),n.classList.toggle(this.settings.menuHoverClass,r)}),e.querySelector(":scope > [aria-expanded]").setAttribute("aria-expanded",r?"true":"false")}focusTabbable(e=1){const t=Array.from(this.nav.querySelectorAll('[tabindex]:not([tabindex="-1"]), a, button')).filter(a=>!a.disabled&&a.tabIndex>=0&&a.offsetParent!==null),r=t.indexOf(document.activeElement);if(t.length===0)return;const n=(r+e+t.length)%t.length;t[n].focus()}tabNext(){this.focusTabbable(1)}tabPrev(){this.focusTabbable(-1)}getTopLevelParentLi(e){let t=e.closest("li");for(;t&&!Array.from(this.topLevelNodes).includes(t);){const r=t.parentElement.closest("ul");t=r?r.closest("li"):null}return t}}o.defaultSettings={menuHoverClass:"show-menu",dir:"ltr"},o.idCounter=0,document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".nav").forEach(c=>new o(c))})})();
